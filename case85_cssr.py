import numpy as np

tg = np.tan(np.arccos(0.7))
l=0.5
CASEDATA = {
    'Vs': 10,   # voltage at node 1 (kV)
    'Vmin': 9.5,    # minimum voltage (kV)
    'alpha': 0.6,   # load factor
    'g': 0.1,   # capital recovery rate
    'cl': 0.1,  # cost of energy loss ($/kWh)
    'delta': 50,    # precentage deviation in load Smax*(1'+/-' delta)
    'branch': np.array([
        # from to length(km) P(kW) Q(kVA)
        [0,  1, l,  0.01, 0.01*tg],
        [1,  2, l,  0.01, 0.01*tg],
        [2,  3, l,  56.0, 56.0*tg],
        [3,  4, l,  0.01, 0.01*tg],
        [4,  5, l,  35.28, 35.28*tg],
        [5,  6, l,  0.01, 0.01*tg],
        [6,  7, l,  35.28, 35.28*tg],
        [7,  8, l,  0.01, 0.01*tg],
        [8,  9, l,  0.01, 0.01*tg],
        [9,  10, l,  56, 56*tg],
        [10,  11, l,  0.01, 0.01*tg],
        [11,  12, l,  0.01, 0.01*tg],
        [12,  13, l,  35.28, 35.28*tg],
        [13,  14, l,  35.28, 35.28*tg],
        [1,  15, l,  35.28, 35.28*tg],
        [2,  16, l,  112, 112*tg],
        [4,  17, l,  56, 56*tg],
        [17,  18, l,  56, 56*tg],
        [18,  19, l,  35.28, 35.28*tg],
        [19,  20, l,  35.28, 35.28*tg],
        [20,  21, l,  35.28, 35.28*tg],
        [18,  22, l,  56, 56*tg],
        [6,  23, l,  35.28, 35.28*tg],
        [7,  24, l,  35.28, 35.28*tg],
        [24,  25, l,  56, 56*tg],
        [25,  26, l,  0.01, 0.01*tg],
        [26,  27, l,  56, 56*tg],
        [27,  28, l,  0.01, 0.01*tg],
        [28,  29, l,  35.28, 35.28*tg],
        [29,  30, l,  35.28, 35.28*tg],
        [30,  31, l,  0.01, 0.01*tg],
        [31,  32, l,  0.01, 0.01*tg],
        [32,  33, l,  14, 14*tg],
        [33,  34, l,  0.01, 0.01*tg],
        [34,  35, l,  35.28, 35.28*tg],
        [25,  36, l,  56, 56*tg],
        [26,  37, l,  56, 56*tg],
        [28,  38, l,  56, 56*tg],
        [31,  39, l,  35.28, 35.28*tg],
        [39,  40, l,  0.01, 0.01*tg],
        [40,  41, l,  35.28, 35.28*tg],
        [40,  42, l,  35.28, 35.28*tg],
        [33,  43, l,  35.28, 35.28*tg],
        [43,  44, l,  35.28, 35.28*tg],
        [44,  45, l,  35.28, 35.28*tg],
        [45,  46, l,  14, 14*tg],
        [34,  47, l,  0.01, 0.01*tg],
        [47,  48, l,  0.01, 0.01*tg],
        [48,  49, l,  35.28, 35.28*tg],
        [49,  50, l,  56, 56*tg],
        [47,  51, l,  0.01, 0.01*tg],
        [51,  52, l,  35.28, 35.28*tg],
        [52,  53, l,  56, 56*tg],
        [51,  54, l,  56, 56*tg],
        [48,  55, l,  14, 14*tg],
        [8,  56, l,  56, 56*tg],
        [56,  57, l,  0.01, 0.01*tg],
        [57,  58, l,  56, 56*tg],
        [57,  59, l,  56, 56*tg],
        [59,  60, l,  56, 56*tg],
        [60,  61, l, 56, 56*tg],
        [59,  62, l,  14, 14*tg],
        [62,  63, l,  0.01, 0.01*tg],
        [63,  64, l,  0.01, 0.01*tg],
        [64,  65, l,  56, 56*tg],
        [63,  66, l,  0.01, 0.01*tg],
        [66,  67, l,  0.01, 0.01*tg],
        [67,  68, l,  56, 56*tg],
        [68,  69, l,  0.01, 0.01*tg],
        [69,  70, l,  35.28, 35.28*tg],
        [66,  71, l,  56, 56*tg],
        [67,  72, l,  0.01, 0.01*tg],
        [72,  73, l,  56, 56*tg],
        [72,  74, l,  35.28, 35.28*tg],
        [69,  75, l,  56, 56*tg],
        [64,  76, l,  14, 14*tg],
        [9,  77, l,  56, 56*tg],
        [66,  78, l,  35.28, 35.28*tg],
        [11,  79, l,  56, 56*tg],
        [79,  80, l,  0.01, 0.01*tg],
        [80,  81, l,  56, 56*tg],
        [80,  82, l,  35.28, 35.28*tg],
        [82,  83, l,  14, 14*tg],
        [12,  84, l,  35.28, 35.28*tg],

    ]),

    'cable': np.array([
        # area(mm^2) r(ohm/km) x(ohm/km) Imax(A) instalation($/km)
        [16,   2.003,  0.136,   85,  12200],
        [25,   1.282,  0.131,  130,  16000],
        [35,   0.866,  0.126,  155,  17200],
        [50,   0.641,  0.121,  180,  20300],
        [70,   0.443,  0.116,  225,  23300],
        [95,   0.320,  0.112,  270,  27600],
        [120,  0.253,  0.108,  305,  34500],
        [150,  0.206,  0.105,  340,  39000],
        [185,  0.130,  0.076,  380,  43500],
    ]),

    'xy': np.array([
        # x(mm) y(mm)
        [7, 0], #1
        [7, -1], #2
        [7, -2], #3
        [6, -3], #4
        [6, -4], #5
        [6, -5], #6
        [6, -6], #7
        [5, -7], #8
        [4, -8], #9
        [3, -9], #10
        [2, -10], #11
        [2, -11], #12
        [1, -12], #13
        [0, -13], #14
        [0, -14], #15
        [8, -2], #16
        [7, -3], #17
        [7, -5], #18
        [7, -6], #19
        [7, -7], #20
        [7, -8], #21
        [7, -9], #22
        [8, -7], #23
        [6, -7], #24
        [5, -8], #25
        [5, -9], #26
        [5, -10], #27
        [5, -11], #28
        [7, -12], #29
        [7, -13], #30
        [7, -14], #31
        [7, -15], #32
        [7, -16], #33
        [7, -17], #34
        [6, -18], #35
        [5, -19], #36
        [6, -10], #37
        [6, -11], #38
        [8, -13], #39
        [8, -16], #40
        [8, -17], #41
        [8, -18], #42
        [9, -18], #43
        [7, -18], #44
        [7, -19], #45
        [8, -20], #46
        [8, -21], #47
        [6, -19], #48
        [5, -20], #49
        [3, -21], #50
        [3, -22], #51
        [6, -20], #52
        [6, -21], #53
        [6, -22], #54
        [7, -21], #55
        [5, -21], #56
        [4, -9], #57
        [4, -10], #58
        [3, -11], #59
        [4, -11], #60
        [4, -12], #61
        [4, -13], #62
        [5, -12], #63
        [5, -13], #64
        [3, -14], #65
        [2,-15], #66
        [5, -14], #67
        [4, -15], #68
        [4,-16], #69
        [4, -17], #70
        [4, -18], #71
        [5, -15], #72
        [5, -16], #73
        [5, -17], #74
        [6, -17], #75
        [5, -18], #76
        [3, -15], #77
        [3, -10], #78
        [6, -15], #79
        [2, -12], #80
        [2, -13], #81
        [1, -14], #82
        [2, -14], #83
        [1, -15], #84
        [1, -13], #85
    ])
}
